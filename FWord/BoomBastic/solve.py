from Crypto.Util.number import getStrongPrime, inverse
from json import loads, dumps
import hashlib, sys, os, signal, random

code = "Boombastic"
secret = 46230676021622845763503163287220143742519607734353143769154445930181151547647686255990785121664365018048887797722884908862479420418472461112615170237294537982241028823528922094978967453001159031830099311261155697036580058769761350399864093502560470069437164053401388293828974880528049848687132374838184795629

s = 15834391753556555450156252491509368378946997530074291255280187064668767412991948651116627796396865851317302640758414356333114267699138537600770378592845579339342937028919524159560625865291740786390470300294932195248874215735975518577448873888448654004051061456141622737987693342594429380733353782657457996946
r = 50596142194566867780090624279655012991038342430776662498322420096730122972832478597576953902581000797617442767014748779861290504160030446552448934148100884372886698749530846989660660147877091423759326122177519589659123047143828299210584766676885342268537279053385613784269202516700163559469348186197238007699
p = 147110285155788083265719149983444992924463572803681601275308544321485521498694013701505565712770497102388806139491279926461065139599040054211580024286826691248851498153215128845537171578033412534244573622689570642927838987686909847120622866427656572687508006595477328859615057518757554721982823667637568761053

def get_ticket(code):
    y = int(hashlib.sha256(code.encode()).hexdigest(),16)
    r = ((y**2 - 1) * (inverse(secret**2, p))) % p
    s = ((1 + y) * (inverse(secret, p))) % p
    return {'s': hex(s), 'r': hex(r), 'p': hex(p)}

word = "Boombastic"
y = int(hashlib.sha256(code.encode()).hexdigest(),16)

#print(f"\nYour ticket : {dumps(get_ticket(word))}")
print((y+1)*(inverse(secret,p)))
print("p = ", p)
print("s =", (y+1)*(inverse(secret,p)) %p)
print("r =", (y-1)*inverse(secret,p)*s %p)
print(r%s)

print(inverse(secret,p))
print(inverse(secret**2,p))


